<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link href="css/styles.css" rel="stylesheet" />
    <script src="js/jquery.min.js"></script>

    <style>
      .employee-details {
        display: flex;
        align-items: center;
        gap: 20px;
        border: 1px solid #ccc;
        padding: 20px;
        border-radius: 10px;
        background-color: #f9f9f9;
      }

      .employee-details img {
        border-radius: 50%;
        width: 150px;
        height: 150px;
        object-fit: cover;
      }

      .employee-info {
        display: flex;
        flex-direction: column;
      }

      .employee-info p {
        margin: 5px 0;
      }
    </style>
  </head>

  <body class="bg-gray-100">
    <div id="container" class="flex">
      <div id="sidebarContainer" class="w-2/12 bg-gray-800 h-screen text-white">
        @@include('components/sidebarForStaff.html')
      </div>
      <div class="flex-grow p-4 w-10/12">
        <!-- Nội dung chính của Staff Screen -->

        <div
          id="employeeDetails"
          class="flex justify-center items-center max-h-screen"
        >
          <div class="w-full shadow-xl rounded-2xl p-10 border bg-white">
            <div
              class="flex flex-col md:flex-row justify-around gap-11 items-center"
            >
              <div id="employeeImage" class="w-full md:w-1/4">
                <img
                  src="https://via.placeholder.com/150"
                  alt="Employee Image"
                  class="rounded-2xl w-full"
                />
              </div>
              <div id="employeeInfo" class="w-full md:w-3/4">
                <h1 class="font-extrabold text-3xl mb-4">Hello [Name]</h1>
                <div class="font-semibold text-lg space-y-2">
                  <!-- Thông tin chi tiết sẽ được đổ vào đây -->
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Các nội dung khác -->
      </div>
    </div>

    <script>
      $(document).ready(function () {
        const token = localStorage.getItem("token");
        // Lấy userId từ localStorage
        const userId = localStorage.getItem("userId");
        if (userId) {
          fetchEmployeeDetails(userId);
        } else {
          alert("Không có thông tin người dùng, vui lòng đăng nhập lại!");
          window.location.href = "/login.html"; // Chuyển về trang đăng nhập
        }

        function fetchEmployeeDetails(employeeId) {
          $.ajax({
            type: "GET",
            headers: {
              Authorization: `Bearer ${token}`,
            },
            url: `http://localhost:8080/employee/listemployee/${employeeId}`, // URL API lấy thông tin chi tiết
            success: function (response) {
              if (response.status === "OK") {
                displayEmployeeDetails(response.data);
              } else {
                alert(response.desc);
              }
            },
            error: function () {
              alert("Không thể lấy thông tin chi tiết của nhân viên!");
            },
          });
        }

        function displayEmployeeDetails(employee) {
          $("#employeeImage img").attr("src", employee.image);
          $("#employeeInfo h1").text(
            `Hello ${employee.firstName} ${employee.lastName}`
          );
          const detailsHtml = `
                    <div><strong>ID:</strong> ${employee.id}</div>
                    <div><strong>Full Name:</strong> ${employee.firstName} ${employee.lastName}</div>
                    <div><strong>Phone Number:</strong> ${employee.phoneNumber}</div>
                    <div><strong>Email:</strong> ${employee.email}</div>
                    <div><strong>Address:</strong> ${employee.address}</div>
                    <div><strong>Role:</strong> ${employee.role.name}</div>
                `;
          $("#employeeInfo .font-semibold").html(detailsHtml);
        }
      });
    </script>
  </body>
</html>
